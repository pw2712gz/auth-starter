<main class="min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 px-4">
  <section
    class="w-full max-w-md bg-white dark:bg-gray-800 p-8 sm:p-10 rounded-xl shadow-lg ring-1 ring-gray-200 dark:ring-gray-700 text-gray-900 dark:text-white"
  >
    <ng-container *ngIf="!loading(); else spinner">
      <!-- App Icon -->
      <img
        alt="App Icon"
        class="w-10 h-10 mx-auto mb-4 rounded-md"
        height="96"
        loading="lazy"
        ngSrc="/favicon.ico"
        width="96"
      />

      <h2 class="text-3xl font-semibold text-center mb-6 tracking-tight">
        Set New Password
      </h2>

      <!-- Password Form -->
      <form
        (ngSubmit)="submit()"
        *ngIf="!submitted()"
        [formGroup]="form"
        aria-label="Reset Password Form"
        class="space-y-4"
      >
        <!-- New Password -->
        <div>
          <input
            autocomplete="new-password"
            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
            formControlName="newPassword"
            placeholder="New password"
            type="password"
          />
          <app-form-error [form]="form" controlName="newPassword"/>
        </div>

        <!-- Error -->
        <app-form-error [error]="errorMessage() || undefined"/>

        <!-- Submit Button -->
        <button
          [disabled]="form.invalid"
          class="w-full py-2 px-4 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition disabled:opacity-50"
          type="submit"
        >
          Reset Password
        </button>
      </form>

      <!-- Success Message -->
      <div *ngIf="submitted()" class="text-center text-green-600 dark:text-green-400">
        âœ… Password successfully reset! Redirecting to
        <a
          class="underline text-blue-600 dark:text-blue-400"
          routerLink="/login"
        >login</a>...
      </div>

      <!-- Back to Login -->
      <div
        class="mt-6 border-t border-gray-200 dark:border-gray-700 pt-4 text-center text-sm text-gray-600 dark:text-gray-400"
      >
        Remembered your password?
        <a
          class="text-blue-600 hover:underline dark:text-blue-400"
          routerLink="/login"
        >Back to Login</a>
      </div>
    </ng-container>

    <!-- Spinner Template -->
    <ng-template #spinner>
      <app-spinner/>
    </ng-template>
  </section>
</main>
